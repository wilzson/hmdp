# 集群的session共享问题
多台Tomcat并不共享session存储空间，当请求切换到不同tomcat会导致数据丢失的问题

所以要采用redis来替换session实现分布式需求。

基于redis实现共享session登录

# Token的引入：
Token是在客户端频繁向服务端请求数据，服务端频繁的去数据库查询用户名和密码并进行对比，判断用户名和密码正确与否，并作出相应提示，在这样的背景下，Token便应运而生。

## Token的定义
Token是服务端生成的一串字符串，以作客户端进行请求的一个令牌，当第一次登录后，服务器生成一个Token便将此Token返回给客户端，以后客户端只需带上这个Token前来请求数据即可，无需再次带上用户名和密码。

## Token的目的
Token的目的是为了减轻服务器的压力，减少频繁的查询数据库，使服务器更加健壮。

## 如何使用Token
### 用mac地址作为Token
客户端：客户端在登录的时候获取mac地址，并作为参数传递给服务端。

服务端：接收到该参数后，用一个变量来接收并同时将其作为Token保存在数据库中，并将该Token设置到session中客户端每次请求的时候都要统一拦截，并将客户端传递的token和服务器端session中的token进行对比，如果相同则放行，不同则拒绝。

### 用session值作为Token

# 缓存更新策略

先操作数据库，再删除缓存的方案
确保数据库和缓存操作的原子性

# 缓存穿透
是指客户端请求的数据在缓存中和数据库中都不存在，这样缓存永远不会生效，这些请求都会打到数据库中，大量的请求可能会导致数据库崩溃
常见解决方法：
- 缓存空对象
- 布隆过滤器
经典加一层，优点：内存占用较少，没有多余key
缺点：实现复杂，存在误判可能（Redis里面自带布隆过滤器）

# 缓存雪崩
同一时间段内大量的缓存key同时失效或者redis服务宕机，导致大量请求达到数据库

# 缓存击穿
一个被高并发访问并且缓存重建业务较复杂的key突然失效了，无数的请求访问会在瞬间在数据库带来巨大的冲击。
- 互斥锁
缺点：等待时间过长，只有一个线程可以抢占资源，其他线程都要等待
- 逻辑过期
